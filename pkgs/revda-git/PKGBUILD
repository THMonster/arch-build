# Maintainer: Megumi_fox <i@megumifox.com>

pkgname=revda-git
pkgver=5.0.0.r6.g1017295
pkgrel=1
pkgdesc='Cute and useful Live Stream Player with danmaku support.'
arch=('x86_64')
url="https://github.com/THMonster/QLivePlayer"
license=('GPL2')
provides=('revda')
conflicts=('revda')
depends=('mpv' 
         'ffmpeg'
         'webkit2gtk'
         )
makedepends=('cmake'
             'git'
             'rust'
             'ninja'
             'yarn'
             'extra-cmake-modules' )

source=(
    "QLivePlayer::git+https://github.com/THMonster/Revda.git#branch=developing"
)

pkgver() {
    cd Revda
    git describe --long --tags | sed 's/\([^-]*-g\)/r\1/;s/-/./g'
}

sha256sums=(
            'SKIP'
)

build() {
	git clone -b developing https://github.com/THMonster/Revda.git --recursive qqq
	cd qqq
	mkdir build
	cd ./build
	cmake -DCMAKE_INSTALL_PREFIX=/usr -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_LIBDIR=lib ..
        make
}

package() {
    cd $srcdir/qqq/build
    make DESTDIR="$pkgdir" install
}
